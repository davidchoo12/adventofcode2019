import math

x = '''#.#................#..............#......#......
.......##..#..#....#.#.....##...#.........#.#...
.#...............#....#.##......................
......#..####.........#....#.......#..#.....#...
.....#............#......#................#.#...
....##...#.#.#.#.............#..#.#.......#.....
..#.#.........#....#..#.#.........####..........
....#...#.#...####..#..#..#.....#...............
.............#......#..........#...........#....
......#.#.........#...............#.............
..#......#..#.....##...##.....#....#.#......#...
...#.......##.........#.#..#......#........#.#..
#.............#..........#....#.#.....#.........
#......#.#................#.......#..#.#........
#..#.#.....#.....###..#.................#..#....
...............................#..........#.....
###.#.....#.....#.............#.......#....#....
.#.....#.........#.....#....#...................
........#....................#..#...............
.....#...#.##......#............#......#.....#..
..#..#..............#..#..#.##........#.........
..#.#...#.......#....##...#........#...#.#....#.
.....#.#..####...........#.##....#....#......#..
.....#..#..##...............................#...
.#....#..#......#.#............#........##...#..
.......#.....................#..#....#.....#....
#......#..###...........#.#....#......#.........
..............#..#.#...#.......#..#.#...#......#
.......#...........#.....#...#.............#.#..
..##..##.............#........#........#........
......#.............##..#.........#...#.#.#.....
#........#.........#...#.....#................#.
...#.#...........#.....#.........#......##......
..#..#...........#..........#...................
.........#..#.......................#.#.........
......#.#.#.....#...........#...............#...
......#.##...........#....#............#........
#...........##.#.#........##...........##.......
......#....#..#.......#.....#.#.......#.##......
.#....#......#..............#.......#...........
......##.#..........#..................#........
......##.##...#..#........#............#........
..#.....#.................###...#.....###.#..#..
....##...............#....#..................#..
.....#................#.#.#.......#..........#..
#........................#.##..........#....##..
.#.........#.#.#...#...#....#........#..#.......
...#..#.#......................#...............#'''

# asteroids = map(lambda line: list(map(lambda char: True if char == '#' else False, line)), x.split('\n'))
width = 48
height = 48
# asteroids = list(list(True if char == '#' else False for char in line) for line in x.split('\n'))
# list of [x, y] coordinates of all asteroids
coords = [[j, i] for i, line in enumerate(x.split('\n')) for j, char in enumerate(line) if char == '#']
# print(len(coords))
# count of unique gradients of all asteroid from all asteroids
gradients = [ len(set([math.atan2(y2-y1, x2-x1) for [x2, y2] in coords])) for [x1, y1] in coords]
laser_xy = coords[gradients.index(max(gradients))]
laser_x = laser_xy[0]
laser_y = laser_xy[1]
print(laser_xy)
coords_from_laser = []
for [x1, y1] in coords:
  theta = math.atan2(laser_y-y1, x1-laser_x) # invert y (y < laser.y is above, y > laser.y is below)
  dist = math.sqrt((laser_x - x1) ** 2 + (laser_y - y1) ** 2) # straight line dist
  if theta > math.pi / 2:
    theta -= 2 * math.pi
  coords_from_laser.append({ 'xy': [x1, y1], 'theta': theta, 'dist': dist })
coords_from_laser = sorted(coords_from_laser, key=lambda k: k['dist'])
coords_from_laser = sorted(coords_from_laser, key=lambda k: k['theta'], reverse=True)
sorting = []

prev_theta = 10
i = 0
while coords_from_laser:
  i %= len(coords_from_laser)
  while coords_from_laser[i]['theta'] == prev_theta:
    i = (i+1) % len(coords_from_laser)
  curr = coords_from_laser.pop(i)
  # print(curr)
  sorting.append(curr)
  prev_theta = curr['theta']
print(sorting[199])

# print(coords_from_laser)

# print(coords_from_laser)